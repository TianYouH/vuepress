<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常用函数代码 | 你好世界</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/blogs/favicon.ico">
    <meta name="description" content="这是我的博客">
    <link rel="preload" href="/blogs/assets/css/0.styles.e18e9f23.css" as="style"><link rel="preload" href="/blogs/assets/js/app.899da232.js" as="script"><link rel="preload" href="/blogs/assets/js/2.c73eb779.js" as="script"><link rel="preload" href="/blogs/assets/js/52.285a2a9a.js" as="script"><link rel="prefetch" href="/blogs/assets/js/10.8b7bb068.js"><link rel="prefetch" href="/blogs/assets/js/11.f7cbab53.js"><link rel="prefetch" href="/blogs/assets/js/12.71918856.js"><link rel="prefetch" href="/blogs/assets/js/13.3ed68190.js"><link rel="prefetch" href="/blogs/assets/js/14.03529f86.js"><link rel="prefetch" href="/blogs/assets/js/15.3053ffb2.js"><link rel="prefetch" href="/blogs/assets/js/16.8e07e3bf.js"><link rel="prefetch" href="/blogs/assets/js/17.33cd47d5.js"><link rel="prefetch" href="/blogs/assets/js/18.9502d3bf.js"><link rel="prefetch" href="/blogs/assets/js/19.29adb430.js"><link rel="prefetch" href="/blogs/assets/js/20.29ec0b81.js"><link rel="prefetch" href="/blogs/assets/js/21.17d4942f.js"><link rel="prefetch" href="/blogs/assets/js/22.f0fbb824.js"><link rel="prefetch" href="/blogs/assets/js/23.50122237.js"><link rel="prefetch" href="/blogs/assets/js/24.8abe6113.js"><link rel="prefetch" href="/blogs/assets/js/25.0921d403.js"><link rel="prefetch" href="/blogs/assets/js/26.8ab63296.js"><link rel="prefetch" href="/blogs/assets/js/27.3d90000f.js"><link rel="prefetch" href="/blogs/assets/js/28.5ec724ef.js"><link rel="prefetch" href="/blogs/assets/js/29.000895f9.js"><link rel="prefetch" href="/blogs/assets/js/3.c7ea1863.js"><link rel="prefetch" href="/blogs/assets/js/30.20b5fc97.js"><link rel="prefetch" href="/blogs/assets/js/31.0e3ad5a4.js"><link rel="prefetch" href="/blogs/assets/js/32.05373c4a.js"><link rel="prefetch" href="/blogs/assets/js/33.2e15565e.js"><link rel="prefetch" href="/blogs/assets/js/34.d30cdedb.js"><link rel="prefetch" href="/blogs/assets/js/35.eeb81f3f.js"><link rel="prefetch" href="/blogs/assets/js/36.e2c9d505.js"><link rel="prefetch" href="/blogs/assets/js/37.3e9ea5d7.js"><link rel="prefetch" href="/blogs/assets/js/38.609f184e.js"><link rel="prefetch" href="/blogs/assets/js/39.66306642.js"><link rel="prefetch" href="/blogs/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/blogs/assets/js/40.906d0533.js"><link rel="prefetch" href="/blogs/assets/js/41.dc08ec12.js"><link rel="prefetch" href="/blogs/assets/js/42.c5da8351.js"><link rel="prefetch" href="/blogs/assets/js/43.a5915163.js"><link rel="prefetch" href="/blogs/assets/js/44.0122b917.js"><link rel="prefetch" href="/blogs/assets/js/45.1ba09b72.js"><link rel="prefetch" href="/blogs/assets/js/46.b38a2295.js"><link rel="prefetch" href="/blogs/assets/js/47.0349128a.js"><link rel="prefetch" href="/blogs/assets/js/48.d4a597db.js"><link rel="prefetch" href="/blogs/assets/js/49.d23bf49b.js"><link rel="prefetch" href="/blogs/assets/js/5.09c2869e.js"><link rel="prefetch" href="/blogs/assets/js/50.737542aa.js"><link rel="prefetch" href="/blogs/assets/js/51.b1a0569a.js"><link rel="prefetch" href="/blogs/assets/js/53.3e1d5bee.js"><link rel="prefetch" href="/blogs/assets/js/54.c8e2f49c.js"><link rel="prefetch" href="/blogs/assets/js/55.8e391b31.js"><link rel="prefetch" href="/blogs/assets/js/56.31495123.js"><link rel="prefetch" href="/blogs/assets/js/57.e78db422.js"><link rel="prefetch" href="/blogs/assets/js/58.802d4b5c.js"><link rel="prefetch" href="/blogs/assets/js/59.92b8be69.js"><link rel="prefetch" href="/blogs/assets/js/6.a4873fcd.js"><link rel="prefetch" href="/blogs/assets/js/60.40738d0f.js"><link rel="prefetch" href="/blogs/assets/js/61.ce3cff27.js"><link rel="prefetch" href="/blogs/assets/js/62.6653dc4a.js"><link rel="prefetch" href="/blogs/assets/js/63.d4b87fe4.js"><link rel="prefetch" href="/blogs/assets/js/7.af43948c.js"><link rel="prefetch" href="/blogs/assets/js/8.fe42ff2a.js"><link rel="prefetch" href="/blogs/assets/js/9.3b7278a3.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.e18e9f23.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><!----> <span class="site-name">你好世界</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/web/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/javascript/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/webapi/" class="nav-link">
  WebApi
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/designMode/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/knowledge/" class="nav-link router-link-active">
  知识点
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/issue/" class="nav-link">
  面试题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务" class="dropdown-title"><span class="title">服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/koa/" class="nav-link">
  Koa
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据" class="dropdown-title"><span class="title">数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/test/" class="nav-link">
  测试
</a></li><li class="dropdown-item"><!----> <a href="/blogs/git/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/blogs/http/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/blogs/linux/" class="nav-link">
  Linux
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/web/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/javascript/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/webapi/" class="nav-link">
  WebApi
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/designMode/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/knowledge/" class="nav-link router-link-active">
  知识点
</a></li><li class="dropdown-item"><!----> <a href="/blogs/web/issue/" class="nav-link">
  面试题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务" class="dropdown-title"><span class="title">服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/koa/" class="nav-link">
  Koa
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据" class="dropdown-title"><span class="title">数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/test/" class="nav-link">
  测试
</a></li><li class="dropdown-item"><!----> <a href="/blogs/git/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/blogs/http/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/blogs/linux/" class="nav-link">
  Linux
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blogs/web/knowledge/" aria-current="page" class="sidebar-link">知识点</a></li><li><a href="/blogs/web/knowledge/OAuth授权.html" class="sidebar-link">OAuth授权</a></li><li><a href="/blogs/web/knowledge/安全.html" class="sidebar-link">安全</a></li><li><a href="/blogs/web/knowledge/常用手写函数.html" class="active sidebar-link">常用函数代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#防抖-debounce" class="sidebar-link">防抖 debounce</a></li><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#节流-throttle" class="sidebar-link">节流 throttle</a></li><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#isequal-手写深度比较" class="sidebar-link">isEqual 手写深度比较</a></li><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#flat-手写数组拍平-值类型" class="sidebar-link">flat 手写数组拍平-值类型</a></li><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#deepclone-手写深拷贝" class="sidebar-link">deepClone 手写深拷贝</a></li><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#bind-手写" class="sidebar-link">bind 手写</a></li><li class="sidebar-sub-header"><a href="/blogs/web/knowledge/常用手写函数.html#jquery-考虑插件和扩展性" class="sidebar-link">jQuery 考虑插件和扩展性</a></li></ul></li><li><a href="/blogs/web/knowledge/初级高频面试题.html" class="sidebar-link">初级高频面试题</a></li><li><a href="/blogs/web/knowledge/性能优化.html" class="sidebar-link">性能优化</a></li><li><a href="/blogs/web/knowledge/运行环境.html" class="sidebar-link">运行环境</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="常用函数代码"><a href="#常用函数代码" class="header-anchor">#</a> 常用函数代码</h1> <h2 id="防抖-debounce"><a href="#防抖-debounce" class="header-anchor">#</a> 防抖 debounce</h2> <div class="language- extra-class"><pre class="language-text"><code>监听一个输入框的，文字变化后触发change事件
直接用keyup 事件，则会频发触发change事件
防抖:用户输入结束或暂停时，才会触发change事件
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> input1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;input1 &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token comment">// input1.addEventListener(&quot;keyup &quot;, function () {</span>
<span class="token comment">//   if (timer) {</span>
<span class="token comment">//     clearTimeout(timer);</span>
<span class="token comment">//   }</span>
<span class="token comment">//   timer = setTimeout(() =&gt; {</span>
<span class="token comment">//     //模拟触发change 事件</span>
<span class="token comment">//     console.log(input1.value);</span>
<span class="token comment">//     //清空定时器</span>
<span class="token comment">//     timer = null;</span>
<span class="token comment">//   }, 500);</span>
<span class="token comment">// });</span>

<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay <span class="token operator">=</span> <span class="token number">500</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// timer 是闭包中的</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

input1<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&quot;keyup&quot;</span><span class="token punctuation">,</span>
  <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>input1<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token number">600</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="节流-throttle"><a href="#节流-throttle" class="header-anchor">#</a> 节流 throttle</h2> <div class="language- extra-class"><pre class="language-text"><code>拖拽一个元素时，要随时拿到该元素被拖拽的位置
直接用drag事件，则会频发触发，很容易导致卡顿
节流:无论拖拽速度多快，都会每隔100ms触发一次
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;div1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// let timer = null;</span>
<span class="token comment">// div1.addEventListener(&quot;drag&quot;, function (e) {</span>
<span class="token comment">//   if (timer) {</span>
<span class="token comment">//     return;</span>
<span class="token comment">//   }</span>
<span class="token comment">//   timer = setTimeout(() =&gt; {</span>
<span class="token comment">//     console.log(e.offsetx, e.offsetY);</span>
<span class="token comment">//     timer = null;</span>
<span class="token comment">//   }, 100);</span>
<span class="token comment">// });</span>

<span class="token comment">//节流</span>

<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay <span class="token operator">=</span> <span class="token number">100</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
div1<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&quot;drag &quot;</span><span class="token punctuation">,</span>
  <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>offsetx<span class="token punctuation">,</span> e<span class="token punctuation">.</span>offsetY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="isequal-手写深度比较"><a href="#isequal-手写深度比较" class="header-anchor">#</a> isEqual 手写深度比较</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">&amp;&amp;</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isEqual</span><span class="token punctuation">(</span><span class="token parameter">obj1<span class="token punctuation">,</span> obj2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//值类型（注意,参与equal的一般不会是函数)</span>
    <span class="token keyword">return</span> obj1 <span class="token operator">===</span> obj2<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj1 <span class="token operator">===</span> obj2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//两个都是对象或数组,而且不相等</span>
  <span class="token comment">// 1。先取出 obj1和 obj2的keys ,比较个数</span>
  <span class="token keyword">const</span> obj1Keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> obj2Keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj1Keys<span class="token punctuation">.</span>length <span class="token operator">!==</span> tobj2Keys<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//2.以obj1 为基准,和obj2一次递归比较</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//比较当前key 的val一递归!!!</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">isEqual</span><span class="token punctuation">(</span>obj1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> obj2<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 3.全相等</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//测试</span>
<span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="flat-手写数组拍平-值类型"><a href="#flat-手写数组拍平-值类型" class="header-anchor">#</a> flat 手写数组拍平-值类型</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">flat</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//验证arr 中,还有没有深层数组[1,2，[3,4]]</span>
  <span class="token keyword">const</span> isDeep <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isDeep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">;</span> <span class="token comment">// 已经是flatern [1，2，3,4]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">flat</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//递归</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="deepclone-手写深拷贝"><a href="#deepclone-手写深拷贝" class="header-anchor">#</a> deepClone 手写深拷贝</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">||</span> obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// obj是null ，或者不是对象和数组，直接返回</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 初始化返回结果</span>
  <span class="token keyword">let</span> result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 保证key 不是原型的属性</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 递归调用!!!</span>
      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//返回结果</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="bind-手写"><a href="#bind-手写" class="header-anchor">#</a> bind 手写</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">band1</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将参数拆解为数组</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 获取 this (数组第一项)</span>
  <span class="token keyword">const</span> t <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// fn1.bind(...) 中的 fn1</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="jquery-考虑插件和扩展性"><a href="#jquery-考虑插件和扩展性" class="header-anchor">#</a> jQuery 考虑插件和扩展性</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">jQuery</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> length <span class="token operator">=</span> result<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">each</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">fn</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 扩展很多 DOM API</span>
<span class="token punctuation">}</span>

<span class="token comment">// 插件</span>
jQuery<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">dialog</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// “造轮子”</span>
<span class="token keyword">class</span> <span class="token class-name">myJQuery</span> <span class="token keyword">extends</span> <span class="token class-name">jQuery</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 扩展自己的方法</span>
  <span class="token function">addClass</span><span class="token punctuation">(</span><span class="token parameter">className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">style</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// const $p = new jQuery('p')</span>
<span class="token comment">// $p.get(1)</span>
<span class="token comment">// $p.each((elem) =&gt; console.log(elem.nodeName))</span>
<span class="token comment">// $p.on('click', () =&gt; alert('clicked'))</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">7/19/2021, 6:35:26 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blogs/web/knowledge/安全.html" class="prev">
        安全
      </a></span> <span class="next"><a href="/blogs/web/knowledge/初级高频面试题.html">
        初级高频面试题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blogs/assets/js/app.899da232.js" defer></script><script src="/blogs/assets/js/2.c73eb779.js" defer></script><script src="/blogs/assets/js/52.285a2a9a.js" defer></script>
  </body>
</html>
